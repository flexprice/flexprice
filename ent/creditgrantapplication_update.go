// Code generated by ent, DO NOT EDIT.

package ent

import (
	"context"
	"errors"
	"fmt"
	"time"

	"entgo.io/ent/dialect/sql"
	"entgo.io/ent/dialect/sql/sqlgraph"
	"entgo.io/ent/schema/field"
	"github.com/flexprice/flexprice/ent/creditgrantapplication"
	"github.com/flexprice/flexprice/ent/predicate"
	"github.com/flexprice/flexprice/internal/types"
	"github.com/shopspring/decimal"
)

// CreditGrantApplicationUpdate is the builder for updating CreditGrantApplication entities.
type CreditGrantApplicationUpdate struct {
	config
	hooks    []Hook
	mutation *CreditGrantApplicationMutation
}

// Where appends a list predicates to the CreditGrantApplicationUpdate builder.
func (cgau *CreditGrantApplicationUpdate) Where(ps ...predicate.CreditGrantApplication) *CreditGrantApplicationUpdate {
	cgau.mutation.Where(ps...)
	return cgau
}

// SetStatus sets the "status" field.
func (cgau *CreditGrantApplicationUpdate) SetStatus(s string) *CreditGrantApplicationUpdate {
	cgau.mutation.SetStatus(s)
	return cgau
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableStatus(s *string) *CreditGrantApplicationUpdate {
	if s != nil {
		cgau.SetStatus(*s)
	}
	return cgau
}

// SetUpdatedAt sets the "updated_at" field.
func (cgau *CreditGrantApplicationUpdate) SetUpdatedAt(t time.Time) *CreditGrantApplicationUpdate {
	cgau.mutation.SetUpdatedAt(t)
	return cgau
}

// SetUpdatedBy sets the "updated_by" field.
func (cgau *CreditGrantApplicationUpdate) SetUpdatedBy(s string) *CreditGrantApplicationUpdate {
	cgau.mutation.SetUpdatedBy(s)
	return cgau
}

// SetNillableUpdatedBy sets the "updated_by" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableUpdatedBy(s *string) *CreditGrantApplicationUpdate {
	if s != nil {
		cgau.SetUpdatedBy(*s)
	}
	return cgau
}

// ClearUpdatedBy clears the value of the "updated_by" field.
func (cgau *CreditGrantApplicationUpdate) ClearUpdatedBy() *CreditGrantApplicationUpdate {
	cgau.mutation.ClearUpdatedBy()
	return cgau
}

// SetScheduledFor sets the "scheduled_for" field.
func (cgau *CreditGrantApplicationUpdate) SetScheduledFor(t time.Time) *CreditGrantApplicationUpdate {
	cgau.mutation.SetScheduledFor(t)
	return cgau
}

// SetNillableScheduledFor sets the "scheduled_for" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableScheduledFor(t *time.Time) *CreditGrantApplicationUpdate {
	if t != nil {
		cgau.SetScheduledFor(*t)
	}
	return cgau
}

// SetAppliedAt sets the "applied_at" field.
func (cgau *CreditGrantApplicationUpdate) SetAppliedAt(t time.Time) *CreditGrantApplicationUpdate {
	cgau.mutation.SetAppliedAt(t)
	return cgau
}

// SetNillableAppliedAt sets the "applied_at" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableAppliedAt(t *time.Time) *CreditGrantApplicationUpdate {
	if t != nil {
		cgau.SetAppliedAt(*t)
	}
	return cgau
}

// ClearAppliedAt clears the value of the "applied_at" field.
func (cgau *CreditGrantApplicationUpdate) ClearAppliedAt() *CreditGrantApplicationUpdate {
	cgau.mutation.ClearAppliedAt()
	return cgau
}

// SetApplicationStatus sets the "application_status" field.
func (cgau *CreditGrantApplicationUpdate) SetApplicationStatus(ts types.ApplicationStatus) *CreditGrantApplicationUpdate {
	cgau.mutation.SetApplicationStatus(ts)
	return cgau
}

// SetNillableApplicationStatus sets the "application_status" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableApplicationStatus(ts *types.ApplicationStatus) *CreditGrantApplicationUpdate {
	if ts != nil {
		cgau.SetApplicationStatus(*ts)
	}
	return cgau
}

// SetCredits sets the "credits" field.
func (cgau *CreditGrantApplicationUpdate) SetCredits(d decimal.Decimal) *CreditGrantApplicationUpdate {
	cgau.mutation.SetCredits(d)
	return cgau
}

// SetNillableCredits sets the "credits" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableCredits(d *decimal.Decimal) *CreditGrantApplicationUpdate {
	if d != nil {
		cgau.SetCredits(*d)
	}
	return cgau
}

// SetSubscriptionStatusAtApplication sets the "subscription_status_at_application" field.
func (cgau *CreditGrantApplicationUpdate) SetSubscriptionStatusAtApplication(ts types.SubscriptionStatus) *CreditGrantApplicationUpdate {
	cgau.mutation.SetSubscriptionStatusAtApplication(ts)
	return cgau
}

// SetNillableSubscriptionStatusAtApplication sets the "subscription_status_at_application" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableSubscriptionStatusAtApplication(ts *types.SubscriptionStatus) *CreditGrantApplicationUpdate {
	if ts != nil {
		cgau.SetSubscriptionStatusAtApplication(*ts)
	}
	return cgau
}

// SetRetryCount sets the "retry_count" field.
func (cgau *CreditGrantApplicationUpdate) SetRetryCount(i int) *CreditGrantApplicationUpdate {
	cgau.mutation.ResetRetryCount()
	cgau.mutation.SetRetryCount(i)
	return cgau
}

// SetNillableRetryCount sets the "retry_count" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableRetryCount(i *int) *CreditGrantApplicationUpdate {
	if i != nil {
		cgau.SetRetryCount(*i)
	}
	return cgau
}

// AddRetryCount adds i to the "retry_count" field.
func (cgau *CreditGrantApplicationUpdate) AddRetryCount(i int) *CreditGrantApplicationUpdate {
	cgau.mutation.AddRetryCount(i)
	return cgau
}

// SetFailureReason sets the "failure_reason" field.
func (cgau *CreditGrantApplicationUpdate) SetFailureReason(s string) *CreditGrantApplicationUpdate {
	cgau.mutation.SetFailureReason(s)
	return cgau
}

// SetNillableFailureReason sets the "failure_reason" field if the given value is not nil.
func (cgau *CreditGrantApplicationUpdate) SetNillableFailureReason(s *string) *CreditGrantApplicationUpdate {
	if s != nil {
		cgau.SetFailureReason(*s)
	}
	return cgau
}

// ClearFailureReason clears the value of the "failure_reason" field.
func (cgau *CreditGrantApplicationUpdate) ClearFailureReason() *CreditGrantApplicationUpdate {
	cgau.mutation.ClearFailureReason()
	return cgau
}

// SetMetadata sets the "metadata" field.
func (cgau *CreditGrantApplicationUpdate) SetMetadata(t types.Metadata) *CreditGrantApplicationUpdate {
	cgau.mutation.SetMetadata(t)
	return cgau
}

// ClearMetadata clears the value of the "metadata" field.
func (cgau *CreditGrantApplicationUpdate) ClearMetadata() *CreditGrantApplicationUpdate {
	cgau.mutation.ClearMetadata()
	return cgau
}

// Mutation returns the CreditGrantApplicationMutation object of the builder.
func (cgau *CreditGrantApplicationUpdate) Mutation() *CreditGrantApplicationMutation {
	return cgau.mutation
}

// Save executes the query and returns the number of nodes affected by the update operation.
func (cgau *CreditGrantApplicationUpdate) Save(ctx context.Context) (int, error) {
	cgau.defaults()
	return withHooks(ctx, cgau.sqlSave, cgau.mutation, cgau.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (cgau *CreditGrantApplicationUpdate) SaveX(ctx context.Context) int {
	affected, err := cgau.Save(ctx)
	if err != nil {
		panic(err)
	}
	return affected
}

// Exec executes the query.
func (cgau *CreditGrantApplicationUpdate) Exec(ctx context.Context) error {
	_, err := cgau.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (cgau *CreditGrantApplicationUpdate) ExecX(ctx context.Context) {
	if err := cgau.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (cgau *CreditGrantApplicationUpdate) defaults() {
	if _, ok := cgau.mutation.UpdatedAt(); !ok {
		v := creditgrantapplication.UpdateDefaultUpdatedAt()
		cgau.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (cgau *CreditGrantApplicationUpdate) check() error {
	if v, ok := cgau.mutation.SubscriptionStatusAtApplication(); ok {
		if err := creditgrantapplication.SubscriptionStatusAtApplicationValidator(string(v)); err != nil {
			return &ValidationError{Name: "subscription_status_at_application", err: fmt.Errorf(`ent: validator failed for field "CreditGrantApplication.subscription_status_at_application": %w`, err)}
		}
	}
	return nil
}

func (cgau *CreditGrantApplicationUpdate) sqlSave(ctx context.Context) (n int, err error) {
	if err := cgau.check(); err != nil {
		return n, err
	}
	_spec := sqlgraph.NewUpdateSpec(creditgrantapplication.Table, creditgrantapplication.Columns, sqlgraph.NewFieldSpec(creditgrantapplication.FieldID, field.TypeString))
	if ps := cgau.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := cgau.mutation.Status(); ok {
		_spec.SetField(creditgrantapplication.FieldStatus, field.TypeString, value)
	}
	if value, ok := cgau.mutation.UpdatedAt(); ok {
		_spec.SetField(creditgrantapplication.FieldUpdatedAt, field.TypeTime, value)
	}
	if cgau.mutation.CreatedByCleared() {
		_spec.ClearField(creditgrantapplication.FieldCreatedBy, field.TypeString)
	}
	if value, ok := cgau.mutation.UpdatedBy(); ok {
		_spec.SetField(creditgrantapplication.FieldUpdatedBy, field.TypeString, value)
	}
	if cgau.mutation.UpdatedByCleared() {
		_spec.ClearField(creditgrantapplication.FieldUpdatedBy, field.TypeString)
	}
	if cgau.mutation.EnvironmentIDCleared() {
		_spec.ClearField(creditgrantapplication.FieldEnvironmentID, field.TypeString)
	}
	if value, ok := cgau.mutation.ScheduledFor(); ok {
		_spec.SetField(creditgrantapplication.FieldScheduledFor, field.TypeTime, value)
	}
	if value, ok := cgau.mutation.AppliedAt(); ok {
		_spec.SetField(creditgrantapplication.FieldAppliedAt, field.TypeTime, value)
	}
	if cgau.mutation.AppliedAtCleared() {
		_spec.ClearField(creditgrantapplication.FieldAppliedAt, field.TypeTime)
	}
	if cgau.mutation.PeriodStartCleared() {
		_spec.ClearField(creditgrantapplication.FieldPeriodStart, field.TypeTime)
	}
	if cgau.mutation.PeriodEndCleared() {
		_spec.ClearField(creditgrantapplication.FieldPeriodEnd, field.TypeTime)
	}
	if value, ok := cgau.mutation.ApplicationStatus(); ok {
		_spec.SetField(creditgrantapplication.FieldApplicationStatus, field.TypeString, value)
	}
	if value, ok := cgau.mutation.Credits(); ok {
		_spec.SetField(creditgrantapplication.FieldCredits, field.TypeOther, value)
	}
	if value, ok := cgau.mutation.SubscriptionStatusAtApplication(); ok {
		_spec.SetField(creditgrantapplication.FieldSubscriptionStatusAtApplication, field.TypeString, value)
	}
	if value, ok := cgau.mutation.RetryCount(); ok {
		_spec.SetField(creditgrantapplication.FieldRetryCount, field.TypeInt, value)
	}
	if value, ok := cgau.mutation.AddedRetryCount(); ok {
		_spec.AddField(creditgrantapplication.FieldRetryCount, field.TypeInt, value)
	}
	if value, ok := cgau.mutation.FailureReason(); ok {
		_spec.SetField(creditgrantapplication.FieldFailureReason, field.TypeString, value)
	}
	if cgau.mutation.FailureReasonCleared() {
		_spec.ClearField(creditgrantapplication.FieldFailureReason, field.TypeString)
	}
	if value, ok := cgau.mutation.Metadata(); ok {
		_spec.SetField(creditgrantapplication.FieldMetadata, field.TypeOther, value)
	}
	if cgau.mutation.MetadataCleared() {
		_spec.ClearField(creditgrantapplication.FieldMetadata, field.TypeOther)
	}
	if n, err = sqlgraph.UpdateNodes(ctx, cgau.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{creditgrantapplication.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return 0, err
	}
	cgau.mutation.done = true
	return n, nil
}

// CreditGrantApplicationUpdateOne is the builder for updating a single CreditGrantApplication entity.
type CreditGrantApplicationUpdateOne struct {
	config
	fields   []string
	hooks    []Hook
	mutation *CreditGrantApplicationMutation
}

// SetStatus sets the "status" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetStatus(s string) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetStatus(s)
	return cgauo
}

// SetNillableStatus sets the "status" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableStatus(s *string) *CreditGrantApplicationUpdateOne {
	if s != nil {
		cgauo.SetStatus(*s)
	}
	return cgauo
}

// SetUpdatedAt sets the "updated_at" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetUpdatedAt(t time.Time) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetUpdatedAt(t)
	return cgauo
}

// SetUpdatedBy sets the "updated_by" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetUpdatedBy(s string) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetUpdatedBy(s)
	return cgauo
}

// SetNillableUpdatedBy sets the "updated_by" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableUpdatedBy(s *string) *CreditGrantApplicationUpdateOne {
	if s != nil {
		cgauo.SetUpdatedBy(*s)
	}
	return cgauo
}

// ClearUpdatedBy clears the value of the "updated_by" field.
func (cgauo *CreditGrantApplicationUpdateOne) ClearUpdatedBy() *CreditGrantApplicationUpdateOne {
	cgauo.mutation.ClearUpdatedBy()
	return cgauo
}

// SetScheduledFor sets the "scheduled_for" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetScheduledFor(t time.Time) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetScheduledFor(t)
	return cgauo
}

// SetNillableScheduledFor sets the "scheduled_for" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableScheduledFor(t *time.Time) *CreditGrantApplicationUpdateOne {
	if t != nil {
		cgauo.SetScheduledFor(*t)
	}
	return cgauo
}

// SetAppliedAt sets the "applied_at" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetAppliedAt(t time.Time) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetAppliedAt(t)
	return cgauo
}

// SetNillableAppliedAt sets the "applied_at" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableAppliedAt(t *time.Time) *CreditGrantApplicationUpdateOne {
	if t != nil {
		cgauo.SetAppliedAt(*t)
	}
	return cgauo
}

// ClearAppliedAt clears the value of the "applied_at" field.
func (cgauo *CreditGrantApplicationUpdateOne) ClearAppliedAt() *CreditGrantApplicationUpdateOne {
	cgauo.mutation.ClearAppliedAt()
	return cgauo
}

// SetApplicationStatus sets the "application_status" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetApplicationStatus(ts types.ApplicationStatus) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetApplicationStatus(ts)
	return cgauo
}

// SetNillableApplicationStatus sets the "application_status" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableApplicationStatus(ts *types.ApplicationStatus) *CreditGrantApplicationUpdateOne {
	if ts != nil {
		cgauo.SetApplicationStatus(*ts)
	}
	return cgauo
}

// SetCredits sets the "credits" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetCredits(d decimal.Decimal) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetCredits(d)
	return cgauo
}

// SetNillableCredits sets the "credits" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableCredits(d *decimal.Decimal) *CreditGrantApplicationUpdateOne {
	if d != nil {
		cgauo.SetCredits(*d)
	}
	return cgauo
}

// SetSubscriptionStatusAtApplication sets the "subscription_status_at_application" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetSubscriptionStatusAtApplication(ts types.SubscriptionStatus) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetSubscriptionStatusAtApplication(ts)
	return cgauo
}

// SetNillableSubscriptionStatusAtApplication sets the "subscription_status_at_application" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableSubscriptionStatusAtApplication(ts *types.SubscriptionStatus) *CreditGrantApplicationUpdateOne {
	if ts != nil {
		cgauo.SetSubscriptionStatusAtApplication(*ts)
	}
	return cgauo
}

// SetRetryCount sets the "retry_count" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetRetryCount(i int) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.ResetRetryCount()
	cgauo.mutation.SetRetryCount(i)
	return cgauo
}

// SetNillableRetryCount sets the "retry_count" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableRetryCount(i *int) *CreditGrantApplicationUpdateOne {
	if i != nil {
		cgauo.SetRetryCount(*i)
	}
	return cgauo
}

// AddRetryCount adds i to the "retry_count" field.
func (cgauo *CreditGrantApplicationUpdateOne) AddRetryCount(i int) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.AddRetryCount(i)
	return cgauo
}

// SetFailureReason sets the "failure_reason" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetFailureReason(s string) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetFailureReason(s)
	return cgauo
}

// SetNillableFailureReason sets the "failure_reason" field if the given value is not nil.
func (cgauo *CreditGrantApplicationUpdateOne) SetNillableFailureReason(s *string) *CreditGrantApplicationUpdateOne {
	if s != nil {
		cgauo.SetFailureReason(*s)
	}
	return cgauo
}

// ClearFailureReason clears the value of the "failure_reason" field.
func (cgauo *CreditGrantApplicationUpdateOne) ClearFailureReason() *CreditGrantApplicationUpdateOne {
	cgauo.mutation.ClearFailureReason()
	return cgauo
}

// SetMetadata sets the "metadata" field.
func (cgauo *CreditGrantApplicationUpdateOne) SetMetadata(t types.Metadata) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.SetMetadata(t)
	return cgauo
}

// ClearMetadata clears the value of the "metadata" field.
func (cgauo *CreditGrantApplicationUpdateOne) ClearMetadata() *CreditGrantApplicationUpdateOne {
	cgauo.mutation.ClearMetadata()
	return cgauo
}

// Mutation returns the CreditGrantApplicationMutation object of the builder.
func (cgauo *CreditGrantApplicationUpdateOne) Mutation() *CreditGrantApplicationMutation {
	return cgauo.mutation
}

// Where appends a list predicates to the CreditGrantApplicationUpdate builder.
func (cgauo *CreditGrantApplicationUpdateOne) Where(ps ...predicate.CreditGrantApplication) *CreditGrantApplicationUpdateOne {
	cgauo.mutation.Where(ps...)
	return cgauo
}

// Select allows selecting one or more fields (columns) of the returned entity.
// The default is selecting all fields defined in the entity schema.
func (cgauo *CreditGrantApplicationUpdateOne) Select(field string, fields ...string) *CreditGrantApplicationUpdateOne {
	cgauo.fields = append([]string{field}, fields...)
	return cgauo
}

// Save executes the query and returns the updated CreditGrantApplication entity.
func (cgauo *CreditGrantApplicationUpdateOne) Save(ctx context.Context) (*CreditGrantApplication, error) {
	cgauo.defaults()
	return withHooks(ctx, cgauo.sqlSave, cgauo.mutation, cgauo.hooks)
}

// SaveX is like Save, but panics if an error occurs.
func (cgauo *CreditGrantApplicationUpdateOne) SaveX(ctx context.Context) *CreditGrantApplication {
	node, err := cgauo.Save(ctx)
	if err != nil {
		panic(err)
	}
	return node
}

// Exec executes the query on the entity.
func (cgauo *CreditGrantApplicationUpdateOne) Exec(ctx context.Context) error {
	_, err := cgauo.Save(ctx)
	return err
}

// ExecX is like Exec, but panics if an error occurs.
func (cgauo *CreditGrantApplicationUpdateOne) ExecX(ctx context.Context) {
	if err := cgauo.Exec(ctx); err != nil {
		panic(err)
	}
}

// defaults sets the default values of the builder before save.
func (cgauo *CreditGrantApplicationUpdateOne) defaults() {
	if _, ok := cgauo.mutation.UpdatedAt(); !ok {
		v := creditgrantapplication.UpdateDefaultUpdatedAt()
		cgauo.mutation.SetUpdatedAt(v)
	}
}

// check runs all checks and user-defined validators on the builder.
func (cgauo *CreditGrantApplicationUpdateOne) check() error {
	if v, ok := cgauo.mutation.SubscriptionStatusAtApplication(); ok {
		if err := creditgrantapplication.SubscriptionStatusAtApplicationValidator(string(v)); err != nil {
			return &ValidationError{Name: "subscription_status_at_application", err: fmt.Errorf(`ent: validator failed for field "CreditGrantApplication.subscription_status_at_application": %w`, err)}
		}
	}
	return nil
}

func (cgauo *CreditGrantApplicationUpdateOne) sqlSave(ctx context.Context) (_node *CreditGrantApplication, err error) {
	if err := cgauo.check(); err != nil {
		return _node, err
	}
	_spec := sqlgraph.NewUpdateSpec(creditgrantapplication.Table, creditgrantapplication.Columns, sqlgraph.NewFieldSpec(creditgrantapplication.FieldID, field.TypeString))
	id, ok := cgauo.mutation.ID()
	if !ok {
		return nil, &ValidationError{Name: "id", err: errors.New(`ent: missing "CreditGrantApplication.id" for update`)}
	}
	_spec.Node.ID.Value = id
	if fields := cgauo.fields; len(fields) > 0 {
		_spec.Node.Columns = make([]string, 0, len(fields))
		_spec.Node.Columns = append(_spec.Node.Columns, creditgrantapplication.FieldID)
		for _, f := range fields {
			if !creditgrantapplication.ValidColumn(f) {
				return nil, &ValidationError{Name: f, err: fmt.Errorf("ent: invalid field %q for query", f)}
			}
			if f != creditgrantapplication.FieldID {
				_spec.Node.Columns = append(_spec.Node.Columns, f)
			}
		}
	}
	if ps := cgauo.mutation.predicates; len(ps) > 0 {
		_spec.Predicate = func(selector *sql.Selector) {
			for i := range ps {
				ps[i](selector)
			}
		}
	}
	if value, ok := cgauo.mutation.Status(); ok {
		_spec.SetField(creditgrantapplication.FieldStatus, field.TypeString, value)
	}
	if value, ok := cgauo.mutation.UpdatedAt(); ok {
		_spec.SetField(creditgrantapplication.FieldUpdatedAt, field.TypeTime, value)
	}
	if cgauo.mutation.CreatedByCleared() {
		_spec.ClearField(creditgrantapplication.FieldCreatedBy, field.TypeString)
	}
	if value, ok := cgauo.mutation.UpdatedBy(); ok {
		_spec.SetField(creditgrantapplication.FieldUpdatedBy, field.TypeString, value)
	}
	if cgauo.mutation.UpdatedByCleared() {
		_spec.ClearField(creditgrantapplication.FieldUpdatedBy, field.TypeString)
	}
	if cgauo.mutation.EnvironmentIDCleared() {
		_spec.ClearField(creditgrantapplication.FieldEnvironmentID, field.TypeString)
	}
	if value, ok := cgauo.mutation.ScheduledFor(); ok {
		_spec.SetField(creditgrantapplication.FieldScheduledFor, field.TypeTime, value)
	}
	if value, ok := cgauo.mutation.AppliedAt(); ok {
		_spec.SetField(creditgrantapplication.FieldAppliedAt, field.TypeTime, value)
	}
	if cgauo.mutation.AppliedAtCleared() {
		_spec.ClearField(creditgrantapplication.FieldAppliedAt, field.TypeTime)
	}
	if cgauo.mutation.PeriodStartCleared() {
		_spec.ClearField(creditgrantapplication.FieldPeriodStart, field.TypeTime)
	}
	if cgauo.mutation.PeriodEndCleared() {
		_spec.ClearField(creditgrantapplication.FieldPeriodEnd, field.TypeTime)
	}
	if value, ok := cgauo.mutation.ApplicationStatus(); ok {
		_spec.SetField(creditgrantapplication.FieldApplicationStatus, field.TypeString, value)
	}
	if value, ok := cgauo.mutation.Credits(); ok {
		_spec.SetField(creditgrantapplication.FieldCredits, field.TypeOther, value)
	}
	if value, ok := cgauo.mutation.SubscriptionStatusAtApplication(); ok {
		_spec.SetField(creditgrantapplication.FieldSubscriptionStatusAtApplication, field.TypeString, value)
	}
	if value, ok := cgauo.mutation.RetryCount(); ok {
		_spec.SetField(creditgrantapplication.FieldRetryCount, field.TypeInt, value)
	}
	if value, ok := cgauo.mutation.AddedRetryCount(); ok {
		_spec.AddField(creditgrantapplication.FieldRetryCount, field.TypeInt, value)
	}
	if value, ok := cgauo.mutation.FailureReason(); ok {
		_spec.SetField(creditgrantapplication.FieldFailureReason, field.TypeString, value)
	}
	if cgauo.mutation.FailureReasonCleared() {
		_spec.ClearField(creditgrantapplication.FieldFailureReason, field.TypeString)
	}
	if value, ok := cgauo.mutation.Metadata(); ok {
		_spec.SetField(creditgrantapplication.FieldMetadata, field.TypeOther, value)
	}
	if cgauo.mutation.MetadataCleared() {
		_spec.ClearField(creditgrantapplication.FieldMetadata, field.TypeOther)
	}
	_node = &CreditGrantApplication{config: cgauo.config}
	_spec.Assign = _node.assignValues
	_spec.ScanValues = _node.scanValues
	if err = sqlgraph.UpdateNode(ctx, cgauo.driver, _spec); err != nil {
		if _, ok := err.(*sqlgraph.NotFoundError); ok {
			err = &NotFoundError{creditgrantapplication.Label}
		} else if sqlgraph.IsConstraintError(err) {
			err = &ConstraintError{msg: err.Error(), wrap: err}
		}
		return nil, err
	}
	cgauo.mutation.done = true
	return _node, nil
}
